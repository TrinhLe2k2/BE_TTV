
@{
    Layout = "~/Views/Shared/Layout.cshtml";
}

<!-- Start content-1 section -->
<section class="p-4" id="Content-section">

    <div class="container">
        <div class="row">

            <div class="col-3 ">
                <h5>Bộ Lọc</h5>
                <form action="~/Home/BoLoc" method="get">
                    @foreach (var item in ViewBag.listCategories)
                    {
                        <div class="p-2">
                            <input type="checkbox" name="arrayId" id="ckb_@item.category_id" value="@item.category_id"> <label for="ckb_@item.category_id">@item.category_name</label>
                        </div>
                    }
                    <input type="submit" value="Hoàn Thành">
                </form>
                
                @*<div class="p-2">
                    <input type="checkbox" name="" id="ck1"> <label for="ck1">Huyền Huyễn</label>
                </div>
                <div class="p-2">
                    <input type="checkbox" name="" id="ck2"> <label for="ck2">Tiên Hiệp</label>
                </div>
                <div class="p-2">
                    <input type="checkbox" name="" id="ck3"> <label for="ck3">Dị Giới</label>
                </div>
                <div class="p-2">
                    <input type="checkbox" name="" id="ck4"> <label for="ck4">Đô Thị</label>
                </div>
                <div class="p-2">
                    <input type="checkbox" name="" id="ck5"> <label for="ck5">Dị Năng</label>
                </div>
                <input type="button" value="Hoàn Thành">*@
            </div>

            <div class="col-9">
                <div class="row">
                    @foreach (var item in ViewBag.listBooks)
                    {
                        <div class=" col-sm-2 col-md-3 p-0 mb-2 pe-2">
                            <a href="/Books/Details/@item.book_id" class="Story-link d-block">
                                <div class="card">
                                    <img src="~/Content/asset/img/@item.book_poster" class="card-img-top" alt="...">
                                    <div class="card-body">
                                        <h5 class="card-title text-center">@item.book_title</h5>
                                        <div class="d-flex justify-content-between align-items-end">
                                            @foreach (var itemChapter in ViewBag.ListLastChapters)
                                            {
                                                if (itemChapter.book_id == item.book_id)
                                                {
                                                    <p class="card-text mb-0">Chương @itemChapter.chapter_number</p>
                                                    <p class="card-text" style="font-size: .8rem;" data-created-at="@itemChapter.chapter_created_at">
                                                        @itemChapter.chapter_created_at
                                                    </p>
                                                }
                                            }

                                        </div>
                                    </div>
                                </div>
                            </a>
                        </div>


                        <script>
                            function getTimeSince(dateTime) {
                                var now = new Date();
                                var timeDiff = now - dateTime;

                                // Chuyển đổi thời gian từ milliseconds sang giờ, phút, giây
                                var seconds = Math.floor(timeDiff / 1000);
                                var minutes = Math.floor(seconds / 60);
                                var hours = Math.floor(minutes / 60);
                                var days = Math.floor(hours / 24);

                                if (days > 0) {
                                    return days + " ngày trước";
                                } else if (hours > 0) {
                                    return hours + " giờ trước";
                                } else if (minutes > 0) {
                                    return minutes + " phút trước";
                                } else {
                                    return "Vừa mới đăng";
                                }
                            }

                            // Lặp qua tất cả các phần tử và cập nhật thời gian trước đó
                            var timeElements = document.querySelectorAll("[data-created-at]");
                            timeElements.forEach(function (element) {
                                var createdDate = new Date(element.dataset.createdAt);
                                element.innerText = getTimeSince(createdDate);
                            });
                        </script>
                    }

                    <div class="row">
                        <nav aria-label="..." class="d-flex justify-content-center">
                            <ul class="pagination">
                                <li class="page-item disabled">
                                    <a class="page-link">Previous</a>
                                </li>
                                <li class="page-item"><a class="page-link" href="#">1</a></li>
                                <li class="page-item active" aria-current="page">
                                    <a class="page-link" href="#">2</a>
                                </li>
                                <li class="page-item"><a class="page-link" href="#">3</a></li>
                                <li class="page-item">
                                    <a class="page-link" href="#">Next</a>
                                </li>
                            </ul>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- End content-1 section -->
